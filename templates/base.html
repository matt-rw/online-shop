{% load static tailwind_tags %}

<!DOCTYPE html>
<html lang="en" data-theme="light" class="scroll-smooth overflow-x-hidden">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=5.0" />
    <title>

      {% block title %}Blueprint Apparel{% endblock %}
    </title>

    <!-- Favicon -->
    <link rel="icon" href="{% static 'favicon.ico' %}" type="image/x-icon" />
    <link rel="icon" href="{% static 'favicon.png' %}" type="image/png" sizes="128x128" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Playfair+Display:wght@400..900&display=swap"
          rel="stylesheet">

    <!-- Stylesheets -->
    <link href="{% static 'css/dist/styles.css' %}" rel="stylesheet" />

    <style>
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Prevent horizontal overflow */
        html,
        body {
            overflow-x: hidden;
            width: 100%;
            position: relative;
        }

        /* Smooth theme transitions */
        html {
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Dark mode styles */
        [data-theme='dark'] {
            background-color: #1a1a1a;
            color: #e5e5e5;
        }

        [data-theme='dark'] body {
            background-color: #1a1a1a;
            color: #e5e5e5;
        }

        [data-theme='dark'] .bg-white {
            background-color: #1a1a1a !important;
        }

        [data-theme='dark'] .text-gray-900 {
            color: #e5e5e5 !important;
        }

        [data-theme='dark'] .bg-gray-100 {
            background-color: #262626 !important;
        }

        [data-theme='dark'] .text-gray-600 {
            color: #a3a3a3 !important;
        }

        [data-theme='dark'] .border-t {
            border-color: #404040 !important;
        }
    </style>

    {% block extra_css %}{% endblock %}
  </head>

  <body class="font-sans antialiased overflow-x-hidden min-h-screen flex flex-col" style="transition: background-color 0.3s ease, color 0.3s ease;">
    <!-- Header -->
    <header class="fixed inset-x-0 top-0 z-50">
      {% include "partials/nav.html" %}

    </header>

    <!-- Main Content -->
    <main class="pt-16 flex-grow">

      {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    {% block footer %}
      {% include 'partials/footer.html' %}
    {% endblock %}

    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 backdrop-blur-sm bg-black/50 z-50 flex items-center justify-center hidden transition-all duration-300 opacity-0">
      <div class="bg-white max-w-md w-full mx-4 transform transition-all duration-300 scale-95 login-modal-content relative border border-black">
        <!-- Close Button -->
        <button type="button" onclick="closeLoginModal()" class="absolute top-4 right-4 text-neutral-400 hover:text-black transition-colors z-10">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>

        <!-- Modal Content -->
        <div class="p-8">
          <!-- Header -->
          <div class="mb-8">
            <span class="text-xs tracking-widest uppercase text-neutral-400 block mb-2">Welcome</span>
            <h2 class="text-2xl font-bold tracking-tight">"SIGN IN"</h2>
          </div>

          <!-- Login Form -->
          <form method="POST" action="{% url 'account_login' %}" class="space-y-4">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ request.path }}">

            <div>
              <label class="text-xs tracking-wider uppercase text-neutral-500 block mb-2">Email</label>
              <input type="email" name="login" required
                     class="w-full px-4 py-3 border border-black text-sm focus:outline-none focus:ring-1 focus:ring-black" />
            </div>

            <div>
              <label class="text-xs tracking-wider uppercase text-neutral-500 block mb-2">Password</label>
              <input type="password" name="password" required
                     class="w-full px-4 py-3 border border-black text-sm focus:outline-none focus:ring-1 focus:ring-black" />
            </div>

            <div class="flex items-center justify-between">
              <label class="flex items-center gap-2 text-xs text-neutral-500">
                <input type="checkbox" name="remember" class="w-4 h-4 border-black">
                Remember me
              </label>
              <a href="{% url 'account_reset_password' %}" class="text-xs text-neutral-500 hover:text-black transition-colors underline">Forgot password?</a>
            </div>

            <button type="submit"
                    class="w-full py-4 bg-black text-white text-xs tracking-widest uppercase font-medium hover:bg-neutral-800 transition-colors">
              Sign In
            </button>
          </form>

          <!-- Divider -->
          <div class="flex items-center gap-4 my-6">
            <span class="flex-1 h-px bg-neutral-200"></span>
            <span class="text-xs text-neutral-400 uppercase tracking-wider">or</span>
            <span class="flex-1 h-px bg-neutral-200"></span>
          </div>

          <!-- Create Account Link -->
          <div class="text-center">
            <p class="text-sm text-neutral-600 mb-3">Don't have an account?</p>
            <a href="{% url 'account_signup' %}"
               class="inline-block w-full py-4 border border-black text-xs tracking-widest uppercase font-medium hover:bg-black hover:text-white transition-colors text-center">
              Create Account
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Login Modal Script -->
    <script>
      function openLoginModal() {
        const modal = document.getElementById('login-modal');
        if (!modal) return;

        modal.classList.remove('hidden');
        setTimeout(() => {
          modal.classList.remove('opacity-0');
          const modalContent = modal.querySelector('.login-modal-content');
          if (modalContent) {
            modalContent.classList.remove('scale-95');
            modalContent.classList.add('scale-100');
          }
        }, 10);
        document.body.style.overflow = 'hidden';
      }

      function closeLoginModal() {
        const modal = document.getElementById('login-modal');
        if (!modal) return;

        modal.classList.add('opacity-0');
        const modalContent = modal.querySelector('.login-modal-content');
        if (modalContent) {
          modalContent.classList.remove('scale-100');
          modalContent.classList.add('scale-95');
        }
        setTimeout(() => {
          modal.classList.add('hidden');
        }, 300);
        document.body.style.overflow = '';
      }

      // Close modal when clicking outside
      document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('login-modal');
        if (modal) {
          modal.addEventListener('click', function(e) {
            if (e.target === modal) {
              closeLoginModal();
            }
          });
        }

        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') {
            const modal = document.getElementById('login-modal');
            if (modal && !modal.classList.contains('hidden')) {
              closeLoginModal();
            }
          }
        });
      });
    </script>

    <!-- Lenis Smooth Scroll -->
    <script type="module">
        import Lenis from 'https://cdn.jsdelivr.net/npm/@studio-freight/lenis@1.0.39/dist/lenis.min.js'
        const lenis = new Lenis({
            smooth: true,
            lerp: 0.08, // Lower = slower, smoother
            wheelMultiplier: 1.0
        })

        function raf(time) {
            lenis.raf(time)
            requestAnimationFrame(raf)
        }
        requestAnimationFrame(raf)
    </script>

    <!-- Dark Mode Toggle -->
    <script>
        // Load saved theme on page load
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            const htmlElement = document.documentElement;
            const darkModeToggle = document.getElementById('darkModeToggle');
            const sunIcon = document.getElementById('sunIcon');
            const moonIcon = document.getElementById('moonIcon');

            // Apply saved theme
            htmlElement.setAttribute('data-theme', savedTheme);
            updateIcons(savedTheme);

            // Toggle dark mode on button click
            if (darkModeToggle) {
                darkModeToggle.addEventListener('click', function() {
                    const currentTheme = htmlElement.getAttribute('data-theme');
                    const newTheme = currentTheme === 'light' ? 'dark' : 'light';

                    htmlElement.setAttribute('data-theme', newTheme);
                    localStorage.setItem('theme', newTheme);
                    updateIcons(newTheme);
                });
            }

            function updateIcons(theme) {
                if (!sunIcon || !moonIcon) return;

                if (theme === 'dark') {
                    sunIcon.classList.add('hidden');
                    moonIcon.classList.remove('hidden');
                } else {
                    sunIcon.classList.remove('hidden');
                    moonIcon.classList.add('hidden');
                }
            }
        });
    </script>

    {% block extra_js %}{% endblock %}
  </body>
</html>
